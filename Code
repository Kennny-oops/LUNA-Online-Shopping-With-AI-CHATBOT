import React from 'react';
import { render, screen, fireEvent } from '@testing-library/react';
import { BrowserRouter as Router } from 'react-router-dom';
import Cart from '../pages/Cart';

describe('Cart Component', () => {
  const mockNavigate = jest.fn();
  const mockSetCart = jest.fn();

  // Mock the useNavigate hook from react-router-dom
  jest.mock('react-router-dom', () => ({
    ...jest.requireActual('react-router-dom'),
    useNavigate: () => mockNavigate,
  }));

  const sampleCart = [
    { id: '1', name: 'Product 1', price: 20, image: 'https://example.com/product1.jpg' },
    { id: '2', name: 'Product 2', price: 15, image: 'https://example.com/product2.jpg' },
  ];

  test('renders empty cart message', () => {
    render(
      <Router>
        <Cart cart={[]} setCart={mockSetCart} />
      </Router>
    );

    expect(screen.getByText(/Your cart is empty./i)).toBeInTheDocument();
  });
import React from 'react';
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { BrowserRouter as Router } from 'react-router-dom';
import Checkout from '../pages/Checkout';
import axios from 'axios';

// Mock useNavigate hook
jest.mock('react-router-dom', () => ({
  ...jest.requireActual('react-router-dom'),
  useNavigate: () => jest.fn(),
}));

// Mock axios for API calls
jest.mock('axios');

describe('Checkout Component', () => {
  const mockNavigate = jest.fn();

  beforeEach(() => {
    jest.clearAllMocks();
  });

  test('renders CheckoutForm when order is not created', () => {
    render(
      <Router>
        <Checkout cartItems={[]} />
      </Router>
    );

    expect(screen.getByText(/Proceed to Checkout/i)).toBeInTheDocument();
  });

  test('shows loading indicator when submitting the form', async () => {
    render(
      <Router>
        <Checkout cartItems={[]} />
      </Router>
    );

    const submitButton = screen.getByText(/Proceed to Checkout/i);
    fireEvent.click(submitButton);

    expect(screen.getByRole('progressbar')).toBeInTheDocument();
  });

  test('displays error message when order creation fails', async () => {
    axios.post.mockRejectedValue(new Error('An error occurred'));

    render(
      <Router>
        <Checkout cartItems={[]} />
      </Router>
    );

    const submitButton = screen.getByText(/Proceed to Checkout/i);
    fireEvent.click(submitButton);

    await waitFor(() => {
      expect(screen.getByText('An error occurred')).toBeInTheDocument();
    });
  });

  test('redirects to order success page on successful order creation', async () => {
    axios.post.mockResolvedValue({ status: 201 });
    render(
      <Router>
        <Checkout cartItems={[]} />
      </Router>
    );

    const submitButton = screen.getByText(/Proceed to Checkout/i);
    fireEvent.click(submitButton);

    await waitFor(() => {
      expect(mockNavigate).toHaveBeenCalledWith('/order-success');
    });
  });
});

import React from 'react';
import { render, screen } from '@testing-library/react';
import { BrowserRouter as Router } from 'react-router-dom';
import Home from '../pages/Home';
import userEvent from '@testing-library/user-event';

describe('Home Component', () => {
  const mockAddToCart = jest.fn();

  const sampleProducts = [
    {
      _id: '1',
      name: 'Product 1',
      price: 100,
      description: 'Description for product 1',
      image: 'https://example.com/product1.jpg',
    },
    {
      _id: '2',
      name: 'Product 2',
      price: 200,
      description: 'Description for product 2',
      image: 'https://example.com/product2.jpg',
    },
    {
      _id: '3',
      name: 'Product 3',
      price: 300,
      description: 'Description for product 3',
      image: 'https://example.com/product3.jpg',
    },
  ];

  test('renders the carousel with images', () => {
    render(
      <Router>
        <Home products={[]} addToCart={mockAddToCart} error={null} loading={false} />
      </Router>
    );

    // Check that the carousel images are rendered
    expect(screen.getByAltText(/Summer Sale - Up to 50% Off/i)).toBeInTheDocument();
    expect(screen.getByAltText(/New Tech Gadgets/i)).toBeInTheDocument();
    expect(screen.getByAltText(/Trending Fashion/i)).toBeInTheDocument();
  });

  test('displays loading indicator when loading is true', () => {
    render(
      <Router>
        <Home products={[]} addToCart={mockAddToCart} error={null} loading={true} />
      </Router>
    );

    // Check for the CircularProgress component
    expect(screen.getByRole('progressbar')).toBeInTheDocument();
  });

  test('displays error message when there is an error', () => {
    const sampleError = { message: 'Failed to fetch products' };

    render(
      <Router>
        <Home products={[]} addToCart={mockAddToCart} error={sampleError} loading={false} />
      </Router>
    );

    // Check for the error message
    expect(screen.getByText(/Failed to fetch products/i)).toBeInTheDocument();
  });

  test('renders featured products when available', () => {
    render(
      <Router>
        <Home products={sampleProducts} addToCart={mockAddToCart} error={null} loading={false} />
      </Router>
    );

    // Check for the presence of product names
    expect(screen.getByText(/Product 1/i)).toBeInTheDocument();
    expect(screen.getByText(/Product 2/i)).toBeInTheDocument();
    expect(screen.getByText(/Product 3/i)).toBeInTheDocument();
  });

  test('renders "Shop Now" button correctly', () => {
    render(
      <Router>
        <Home products={[]} addToCart={mockAddToCart} error={null} loading={false} />
      </Router>
    );

    const shopNowButton = screen.getByRole('button', { name: /Shop Now/i });

    // Check if the button is in the document
    expect(shopNowButton).toBeInTheDocument();

    // Simulate click to test navigation or any side effects
    userEvent.click(shopNowButton);

    // Check for correct href attribute
    expect(shopNowButton.closest('a')).toHaveAttribute('href', '/shop');
  });
});


import React from 'react';
import { render, screen } from '@testing-library/react';
import OrderSuccess from '../pages/OrderSuccess';

describe('OrderSuccess Component', () => {
  test('renders success icon', () => {
    render(<OrderSuccess />);

    // Check for the success icon by its role
    const successIcon = screen.getByTestId('CheckCircleOutlineIcon');
    expect(successIcon).toBeInTheDocument();
  });

  test('displays order success message', () => {
    render(<OrderSuccess />);

    // Check for the success message
    expect(screen.getByText(/Order Successful!/i)).toBeInTheDocument();
  });

  test('displays additional information message', () => {
    render(<OrderSuccess />);

    // Check for the additional information text
    expect(screen.getByText(/Thank you for your purchase. Your order is being processed./i)).toBeInTheDocument();
  });
});


import React from 'react';
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { BrowserRouter as Router } from 'react-router-dom';
import axios from 'axios';
import ProductDetails from '../pages/ProductDetails';

// Mock useNavigate hook
jest.mock('react-router-dom', () => ({
  ...jest.requireActual('react-router-dom'),
  useNavigate: () => jest.fn(),
  useParams: () => ({ id: '1' }), // Mock the id parameter
}));

// Mock axios for API calls
jest.mock('axios');

describe('ProductDetails Component', () => {
  const mockAddToCart = jest.fn();

  const sampleProduct = {
    _id: '1',
    name: 'Sample Product',
    brand: 'Brand A',
    category: 'Category A',
    price: 100,
    description: 'This is a sample product description.',
    image: 'https://example.com/product1.jpg',
    stock: 10,
    rating: 4,
    numReviews: 5,
  };

  beforeEach(() => {
    jest.clearAllMocks();
  });

  test('renders loading state initially', () => {
    render(
      <Router>
        <ProductDetails addToCart={mockAddToCart} />
      </Router>
    );

    // Check for the loading indicator
    expect(screen.getByRole('progressbar')).toBeInTheDocument();
  });

  test('displays error message when there is an error', async () => {
    axios.get.mockRejectedValue(new Error('Failed to load product details'));

    render(
      <Router>
        <ProductDetails addToCart={mockAddToCart} />
      </Router>
    );

    await waitFor(() => {
      // Check for the error message
      expect(screen.getByText(/Error loading product details/i)).toBeInTheDocument();
    });
  });

  test('renders product details when data is fetched successfully', async () => {
    axios.get.mockResolvedValue({ data: sampleProduct });

    render(
      <Router>
        <ProductDetails addToCart={mockAddToCart} />
      </Router>
    );

    await waitFor(() => {
      // Check for the product name
      expect(screen.getByText(/Sample Product/i)).toBeInTheDocument();
      // Check for the brand
      expect(screen.getByText(/Brand: Brand A/i)).toBeInTheDocument();
      // Check for the category
      expect(screen.getByText(/Category: Category A/i)).toBeInTheDocument();
      // Check for the price
      expect(screen.getByText(/\$100/i)).toBeInTheDocument();
      // Check for the description
      expect(screen.getByText(/This is a sample product description./i)).toBeInTheDocument();
      // Check for the stock message
      expect(screen.getByText(/10 Available/i)).toBeInTheDocument();
      // Check for the rating and number of reviews
      expect(screen.getByText(/\(5 Reviews\)/i)).toBeInTheDocument();
    });
  });

  test('handles add to cart functionality', async () => {
    axios.get.mockResolvedValue({ data: sampleProduct });

    render(
      <Router>
        <ProductDetails addToCart={mockAddToCart} />
      </Router>
    );

    await waitFor(() => {
      const addToCartButton = screen.getByRole('button', { name: /Add to Cart/i });
      fireEvent.click(addToCartButton);
      expect(mockAddToCart).toHaveBeenCalledWith(sampleProduct);
    });
  });

  test('handles rating change', async () => {
    axios.get.mockResolvedValue({ data: sampleProduct });
    axios.put.mockResolvedValue({ data: { ...sampleProduct, rating: 4.5, numReviews: 6 } });

    render(
      <Router>
        <ProductDetails addToCart={mockAddToCart} />
      </Router>
    );

    await waitFor(() => {
      const ratingStars = screen.getByLabelText('4 Stars');
      // eslint-disable-next-line testing-library/no-wait-for-side-effects
      fireEvent.click(ratingStars);
    });

    await waitFor(() => {
      // Check if the new rating was submitted
      expect(axios.put).toHaveBeenCalledWith('http://localhost:5000/api/products/1/rating', { rating: 4.5 });
    });
  });
});





import React from 'react';
import { render, screen, fireEvent } from '@testing-library/react';
import Shop from '../pages/Shop';
import { BrowserRouter as Router } from 'react-router-dom';

describe('Shop Component', () => {
  const mockAddToCart = jest.fn();

  const sampleProducts = [
    { id: '1', name: 'Product 1', category: 'Electronics', price: 100, image: 'https://example.com/product1.jpg' },
    { id: '2', name: 'Product 2', category: 'Clothing', price: 200, image: 'https://example.com/product2.jpg' },
    { id: '3', name: 'Product 3', category: 'Electronics', price: 300, image: 'https://example.com/product3.jpg' },
    { id: '4', name: 'Product 4', category: 'Books', price: 150, image: 'https://example.com/product4.jpg' },
    { id: '5', name: 'Product 5', category: 'Clothing', price: 50, image: 'https://example.com/product5.jpg' },
    { id: '6', name: 'Product 6', category: 'Books', price: 250, image: 'https://example.com/product6.jpg' },
    { id: '7', name: 'Product 7', category: 'Electronics', price: 180, image: 'https://example.com/product7.jpg' },
  ];

  beforeEach(() => {
    jest.clearAllMocks();
  });

  test('renders Shop component with products', () => {
    render(
      <Router>
        <Shop products={sampleProducts} addToCart={mockAddToCart} />
      </Router>
    );

    // Check that the component displays the title
    expect(screen.getByText(/Shop/i)).toBeInTheDocument();

    // Check that the first few products are rendered
    expect(screen.getByText(/Product 1/i)).toBeInTheDocument();
    expect(screen.getByText(/Product 2/i)).toBeInTheDocument();
    expect(screen.getByText(/Product 3/i)).toBeInTheDocument();
  });

  test('filters products by category', () => {
    render(
      <Router>
        <Shop products={sampleProducts} addToCart={mockAddToCart} />
      </Router>
    );

    // Select category 'Electronics'
    fireEvent.mouseDown(screen.getByLabelText(/Filter by Category/i));
    fireEvent.click(screen.getByText(/Electronics/i));

    // Ensure that only products from the selected category are displayed
    expect(screen.getByText(/Product 1/i)).toBeInTheDocument();
    expect(screen.getByText(/Product 3/i)).toBeInTheDocument();
    expect(screen.getByText(/Product 7/i)).toBeInTheDocument();

    // Ensure that products from other categories are not displayed
    expect(screen.queryByText(/Product 2/i)).not.toBeInTheDocument();
    expect(screen.queryByText(/Product 4/i)).not.toBeInTheDocument();
  });

  test('displays pagination and handles page change', () => {
    render(
      <Router>
        <Shop products={sampleProducts} addToCart={mockAddToCart} />
      </Router>
    );

    // Check that pagination is rendered
    const pagination = screen.getByRole('navigation');
    expect(pagination).toBeInTheDocument();

    // Verify initial state of the page
    expect(screen.getByText(/Product 1/i)).toBeInTheDocument();
    expect(screen.queryByText(/Product 7/i)).not.toBeInTheDocument();

    // Simulate page change to 2
    fireEvent.click(screen.getByRole('button', { name: /2/i }));

    // Ensure products from the second page are displayed
    expect(screen.getByText(/Product 7/i)).toBeInTheDocument();
    expect(screen.queryByText(/Product 1/i)).not.toBeInTheDocument();
  });

  test('resets to first page on category change', () => {
    render(
      <Router>
        <Shop products={sampleProducts} addToCart={mockAddToCart} />
      </Router>
    );

    // Change to page 2
    fireEvent.click(screen.getByRole('button', { name: /2/i }));
    expect(screen.getByText(/Product 7/i)).toBeInTheDocument();

    // Change category to 'Books'
    fireEvent.mouseDown(screen.getByLabelText(/Filter by Category/i));
    fireEvent.click(screen.getByText(/Books/i));

    // Verify that it resets to the first page
    expect(screen.getByText(/Product 4/i)).toBeInTheDocument();
    expect(screen.getByText(/Product 6/i)).toBeInTheDocument();
    expect(screen.queryByText(/Product 7/i)).not.toBeInTheDocument();
  });
});
